{"version":3,"sources":["../src/functions/validateSchemaPropertyPatternRegex.ts","../node_modules/@stoplight/types/dist/index.mjs","../src/ruleset.ts"],"sourcesContent":["import { isSafe } from 'redos-detector';\nconst validateSchemaPropertyPatternRegex = (param: any): any => {\n  for (const [key, value] of Object.entries(param)) {\n    console.log(param, 'param')\n    if (key.toLowerCase().includes('pattern')) {\n      if (!isSafe(new RegExp(`${value}`)).safe) {\n        return [\n          {\n            message: `${value} This pattern is not safe from ReDoS attacks. There may be infinite backtracks possible in the worst case.`,\n          }\n        ]\n      }\n    }\n  }\n}\n\nexport default validateSchemaPropertyPatternRegex\n","var HttpParamStyles;\n(function (HttpParamStyles) {\n    HttpParamStyles[\"Simple\"] = \"simple\";\n    HttpParamStyles[\"Matrix\"] = \"matrix\";\n    HttpParamStyles[\"Label\"] = \"label\";\n    HttpParamStyles[\"Form\"] = \"form\";\n    HttpParamStyles[\"CommaDelimited\"] = \"commaDelimited\";\n    HttpParamStyles[\"SpaceDelimited\"] = \"spaceDelimited\";\n    HttpParamStyles[\"PipeDelimited\"] = \"pipeDelimited\";\n    HttpParamStyles[\"DeepObject\"] = \"deepObject\";\n})(HttpParamStyles || (HttpParamStyles = {}));\n\n/**\n * Represents the severity of diagnostics.\n */\nvar DiagnosticSeverity;\n(function (DiagnosticSeverity) {\n    /**\n     * Something not allowed by the rules of a language or other means.\n     */\n    DiagnosticSeverity[DiagnosticSeverity[\"Error\"] = 0] = \"Error\";\n    /**\n     * Something suspicious but allowed.\n     */\n    DiagnosticSeverity[DiagnosticSeverity[\"Warning\"] = 1] = \"Warning\";\n    /**\n     * Something to inform about but not a problem.\n     */\n    DiagnosticSeverity[DiagnosticSeverity[\"Information\"] = 2] = \"Information\";\n    /**\n     * Something to hint to a better way of doing it, like proposing\n     * a refactoring.\n     */\n    DiagnosticSeverity[DiagnosticSeverity[\"Hint\"] = 3] = \"Hint\";\n})(DiagnosticSeverity || (DiagnosticSeverity = {}));\n\n/**\n * Stoplight node types\n */\nvar NodeType;\n(function (NodeType) {\n    NodeType[\"Article\"] = \"article\";\n    NodeType[\"HttpService\"] = \"http_service\";\n    NodeType[\"HttpServer\"] = \"http_server\";\n    NodeType[\"HttpOperation\"] = \"http_operation\";\n    NodeType[\"Model\"] = \"model\";\n    NodeType[\"Generic\"] = \"generic\";\n    NodeType[\"Unknown\"] = \"unknown\";\n    NodeType[\"TableOfContents\"] = \"table_of_contents\";\n    NodeType[\"SpectralRuleset\"] = \"spectral_ruleset\";\n    NodeType[\"Styleguide\"] = \"styleguide\";\n    NodeType[\"Image\"] = \"image\";\n})(NodeType || (NodeType = {}));\n/**\n * Node data formats\n */\nvar NodeFormat;\n(function (NodeFormat) {\n    NodeFormat[\"Json\"] = \"json\";\n    NodeFormat[\"Markdown\"] = \"markdown\";\n    NodeFormat[\"Yaml\"] = \"yaml\";\n    NodeFormat[\"Javascript\"] = \"javascript\";\n    NodeFormat[\"Apng\"] = \"apng\";\n    NodeFormat[\"Avif\"] = \"avif\";\n    NodeFormat[\"Bmp\"] = \"bmp\";\n    NodeFormat[\"Gif\"] = \"gif\";\n    NodeFormat[\"Jpeg\"] = \"jpeg\";\n    NodeFormat[\"Png\"] = \"png\";\n    NodeFormat[\"Svg\"] = \"svg\";\n    NodeFormat[\"Webp\"] = \"webp\";\n})(NodeFormat || (NodeFormat = {}));\n\nexport { DiagnosticSeverity, HttpParamStyles, NodeFormat, NodeType };\n","import validateSchemaPropertyPatternRegex from \"./functions/validateSchemaPropertyPatternRegex\";\nimport { DiagnosticSeverity } from \"@stoplight/types\";\nexport default {\n    rules: {\n        \"unsafe-pattern-regex-schema-property\": {\n            description: \"Regex patterns for schema properties must be safe\",\n            given: '$.components.schemas..properties[*]',\n            message: '{{error}}',\n            severity: DiagnosticSeverity.Error,\n            then: {\n                function: validateSchemaPropertyPatternRegex\n            }\n        }\n    }\n}\n"],"mappings":";AAAA,SAAS,cAAc;AACvB,IAAM,qCAAqC,CAAC,UAAoB;AAC9D,aAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,KAAK,GAAG;AAChD,YAAQ,IAAI,OAAO,OAAO;AAC1B,QAAI,IAAI,YAAY,EAAE,SAAS,SAAS,GAAG;AACzC,UAAI,CAAC,OAAO,IAAI,OAAO,GAAG,OAAO,CAAC,EAAE,MAAM;AACxC,eAAO;AAAA,UACL;AAAA,YACE,SAAS,GAAG;AAAA,UACd;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF;AAEA,IAAO,6CAAQ;;;AChBf,IAAI;AAAA,CACH,SAAUA,kBAAiB;AACxB,EAAAA,iBAAgB,YAAY;AAC5B,EAAAA,iBAAgB,YAAY;AAC5B,EAAAA,iBAAgB,WAAW;AAC3B,EAAAA,iBAAgB,UAAU;AAC1B,EAAAA,iBAAgB,oBAAoB;AACpC,EAAAA,iBAAgB,oBAAoB;AACpC,EAAAA,iBAAgB,mBAAmB;AACnC,EAAAA,iBAAgB,gBAAgB;AACpC,GAAG,oBAAoB,kBAAkB,CAAC,EAAE;AAK5C,IAAI;AAAA,CACH,SAAUC,qBAAoB;AAI3B,EAAAA,oBAAmBA,oBAAmB,WAAW,KAAK;AAItD,EAAAA,oBAAmBA,oBAAmB,aAAa,KAAK;AAIxD,EAAAA,oBAAmBA,oBAAmB,iBAAiB,KAAK;AAK5D,EAAAA,oBAAmBA,oBAAmB,UAAU,KAAK;AACzD,GAAG,uBAAuB,qBAAqB,CAAC,EAAE;AAKlD,IAAI;AAAA,CACH,SAAUC,WAAU;AACjB,EAAAA,UAAS,aAAa;AACtB,EAAAA,UAAS,iBAAiB;AAC1B,EAAAA,UAAS,gBAAgB;AACzB,EAAAA,UAAS,mBAAmB;AAC5B,EAAAA,UAAS,WAAW;AACpB,EAAAA,UAAS,aAAa;AACtB,EAAAA,UAAS,aAAa;AACtB,EAAAA,UAAS,qBAAqB;AAC9B,EAAAA,UAAS,qBAAqB;AAC9B,EAAAA,UAAS,gBAAgB;AACzB,EAAAA,UAAS,WAAW;AACxB,GAAG,aAAa,WAAW,CAAC,EAAE;AAI9B,IAAI;AAAA,CACH,SAAUC,aAAY;AACnB,EAAAA,YAAW,UAAU;AACrB,EAAAA,YAAW,cAAc;AACzB,EAAAA,YAAW,UAAU;AACrB,EAAAA,YAAW,gBAAgB;AAC3B,EAAAA,YAAW,UAAU;AACrB,EAAAA,YAAW,UAAU;AACrB,EAAAA,YAAW,SAAS;AACpB,EAAAA,YAAW,SAAS;AACpB,EAAAA,YAAW,UAAU;AACrB,EAAAA,YAAW,SAAS;AACpB,EAAAA,YAAW,SAAS;AACpB,EAAAA,YAAW,UAAU;AACzB,GAAG,eAAe,aAAa,CAAC,EAAE;;;ACpElC,IAAO,kBAAQ;AAAA,EACX,OAAO;AAAA,IACH,wCAAwC;AAAA,MACpC,aAAa;AAAA,MACb,OAAO;AAAA,MACP,SAAS;AAAA,MACT,UAAU,mBAAmB;AAAA,MAC7B,MAAM;AAAA,QACF,UAAU;AAAA,MACd;AAAA,IACJ;AAAA,EACJ;AACJ;","names":["HttpParamStyles","DiagnosticSeverity","NodeType","NodeFormat"]}